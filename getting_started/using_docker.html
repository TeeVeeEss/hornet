<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using Docker - HORNET Docs</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../welcome.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item expanded "><a href="../getting_started/getting_started.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/nodes_101.html"><strong aria-hidden="true">2.1.</strong> Nodes 101</a></li><li class="chapter-item expanded "><a href="../getting_started/security_101.html"><strong aria-hidden="true">2.2.</strong> Security 101</a></li><li class="chapter-item expanded "><a href="../getting_started/installation_steps.html"><strong aria-hidden="true">2.3.</strong> Installation steps</a></li><li class="chapter-item expanded "><a href="../getting_started/using_docker.html" class="active"><strong aria-hidden="true">2.4.</strong> Using Docker</a></li><li class="chapter-item expanded "><a href="../getting_started/using_docker_compose.html"><strong aria-hidden="true">2.5.</strong> Using Docker compose</a></li><li class="chapter-item expanded "><a href="../getting_started/bootstrap_from_genesis_snapshot.html"><strong aria-hidden="true">2.6.</strong> Bootstrapping from genesis snapshot</a></li><li class="chapter-item expanded "><a href="../getting_started/private_tangle.html"><strong aria-hidden="true">2.7.</strong> Private Tangle</a></li></ol></li><li class="chapter-item expanded "><a href="../post_installation/post_installation.html"><strong aria-hidden="true">3.</strong> Post-installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../post_installation/managing.html"><strong aria-hidden="true">3.1.</strong> Managing node</a></li><li class="chapter-item expanded "><a href="../post_installation/config.html"><strong aria-hidden="true">3.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../post_installation/peering.html"><strong aria-hidden="true">3.3.</strong> Peering</a></li><li class="chapter-item expanded "><a href="../post_installation/run_as_verifier.html"><strong aria-hidden="true">3.4.</strong> Run as verifier</a></li></ol></li><li class="chapter-item expanded "><a href="../api-reference.html"><strong aria-hidden="true">4.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="../troubleshooting.html"><strong aria-hidden="true">5.</strong> Troubleshooting</a></li><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">6.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="../Contribution.html"><strong aria-hidden="true">7.</strong> Contribution</a></li><li class="chapter-item expanded "><a href="../code_of_conduct.html"><strong aria-hidden="true">8.</strong> Code of Conduct</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">HORNET Docs</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="using-docker"><a class="header" href="#using-docker">Using Docker</a></h1>
<p>Hornet Docker images (amd64/x86_64 architecture) are available at <a href="https://hub.docker.com/r/gohornet/hornet">gohornet/hornet</a> Docker hub.</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<ol>
<li>A recent release of Docker enterprise or community edition. (Follow this <a href="https://docs.docker.com/engine/install/">link</a> for install instructions).</li>
<li>git and curl</li>
<li>At least 1GB available RAM</li>
</ol>
<h2 id="clone-repository"><a class="header" href="#clone-repository">Clone Repository</a></h2>
<p>Clone the repository</p>
<pre><code class="language-sh">git clone https://github.com/gohornet/hornet &amp;&amp; cd hornet
</code></pre>
<p>The rest of the document assumes you are executing commands from the root directory of the repository.</p>
<h2 id="prepare"><a class="header" href="#prepare">Prepare</a></h2>
<ol>
<li>
<p>Edit the <code>config.json</code> for alternative ports if needed.</p>
</li>
<li>
<p>Edit <code>peering.json</code> to your neighbors addresses.</p>
</li>
<li>
<p>The Docker image runs under user with user id 65532 and group id 65532. To make sure there are no permission issues, create the directory for the database, e.g.:</p>
<pre><code class="language-sh">sudo mkdir mainnetdb &amp;&amp; sudo chown 65532:65532 mainnetdb
</code></pre>
</li>
<li>
<p>The Docker image runs under user with user id 65532 and group id 65532. To make sure there are no permission issues, create the directory for the snapshots, e.g.:</p>
<pre><code class="language-sh">sudo mkdir -p snapshots/mainnet &amp;&amp; sudo chown 65532:65532 snapshots -R
</code></pre>
</li>
</ol>
<h2 id="run"><a class="header" href="#run">Run</a></h2>
<p>Pull the latest image from <code>gohornet/hornet</code> public Docker hub registry:</p>
<pre><code class="language-bash">docker pull gohornet/hornet:latest
</code></pre>
<p>Best is to run on host network for better performance (otherwise you are going to have to publish ports, that is done via iptables NAT and is slower)</p>
<pre><code class="language-sh">docker run \
  -v $(pwd)/config.json:/app/config.json:ro \
  -v $(pwd)/peering.json:/app/peering.json \
  -v $(pwd)/profiles.json:/app/profiles.json \
  -v $(pwd)/mainnetdb:/app/mainnetdb \
  -v $(pwd)/snapshots/mainnet:/app/snapshots/mainnet \
  --restart always \
  --name hornet\
  --net=host \
  -d \
  hornet:latest
</code></pre>
<p>Use <code>docker stop -t 200 hornet</code> to gracefully end the process.</p>
<ul>
<li><code>$(pwd)</code> <br />
Is for the current directory. All mentioned directories are mapped to container and so the Hornet in container persists the data directly to those directories.</li>
<li><code>-v $(pwd)/config.json:/app/config.json:ro</code> <br />
Maps the local <code>config.json</code> file into the container in <code>readonly</code> mode.</li>
<li><code>-v $(pwd)/peering.json:/app/peering.json</code> <br />
Maps the local <code>peering.json</code> file into the container.</li>
<li><code>-v $(pwd)/snapshots/mainnet:/app/snapshots/mainnet</code> <br />
Maps the local <code>snapshots</code> directory into the container.</li>
<li><code>-v $(pwd)/mainnetdb:/app/mainnetdb</code> <br />
Maps the local <code>mainnetdb</code> directory into the container.</li>
<li><code>--restart always</code> <br />
Instructs Docker the given container is restarted after Docker reboot</li>
<li><code>--name hornet</code> <br />
Name of the running container instance. You can refer to the given container by this name.</li>
<li><code>--net=host</code> <br />
Instructs Docker to use directly network on host (so the network is not isolated). The best is to run on host network for better performance. It also means it is not necessary to specify any ports. Ports that are opened by container are opened directly on the host.</li>
<li><code>-d</code> <br />
Instructs Docker to run the container instance in a detached mode (daemon).</li>
</ul>
<h2 id="create-username-and-password-for-the-hornet-dashboard"><a class="header" href="#create-username-and-password-for-the-hornet-dashboard">Create username and password for the Hornet dashboard</a></h2>
<p>If you use the Hornet dashboard you need to create a secure password. Start your Hornet container and run the following command when the container is running:</p>
<pre><code class="language-sh">docker exec -it hornet /app/hornet tool pwdhash

Re-enter your password:
Success!
Your hash: [YOUR_HASH_HERE]
Your salt: [YOUR_SALT_HERE]
</code></pre>
<p>Edit <code>config.json</code> and customize the &quot;dashboard&quot; section to your needs.</p>
<pre><code class="language-sh">  &quot;dashboard&quot;: {
    &quot;bindAddress&quot;: &quot;0.0.0.0:8081&quot;,
    &quot;auth&quot;: {
      &quot;sessionTimeout&quot;: &quot;72h&quot;,
      &quot;username&quot;: &quot;admin&quot;,
      &quot;passwordHash&quot;: &quot;[YOUR_HASH_HERE]&quot;,
      &quot;passwordSalt&quot;: &quot;[YOUR_SALT_HERE]&quot;
    }
  },
</code></pre>
<h2 id="build-your-own-hornet-image"><a class="header" href="#build-your-own-hornet-image">Build your own hornet image</a></h2>
<p>You can build your own Docker image by running the following command:</p>
<pre><code class="language-sh">docker build -f docker/Dockerfile -t hornet:latest .
</code></pre>
<p>Or pull it from Docker hub (only available for amd64/x86_64):</p>
<pre><code class="language-sh">docker pull gohornet/hornet:latest &amp;&amp; docker tag gohornet/hornet:latest hornet:latest
</code></pre>
<h2 id="managing-node"><a class="header" href="#managing-node">Managing node</a></h2>
<blockquote>
<p>Please note: Hornet uses an in-memory cache and so it is necessary to provide a grace period while shutting it down (at least 200 seconds) in order to save all data to the underlying persistent storage.</p>
</blockquote>
<h3 id="starting-an-existing-hornet"><a class="header" href="#starting-an-existing-hornet">Starting an existing Hornet</a></h3>
<pre><code class="language-bash">docker start hornet
</code></pre>
<h3 id="restarting-hornet"><a class="header" href="#restarting-hornet">Restarting Hornet</a></h3>
<pre><code class="language-bash">docker restart -t 200 hornet
</code></pre>
<ul>
<li><code>-t 200</code>: instructs Docker to wait for a grace period before shutting down</li>
</ul>
<h3 id="stopping-hornet"><a class="header" href="#stopping-hornet">Stopping Hornet</a></h3>
<pre><code class="language-bash">docker stop -t 200 hornet
</code></pre>
<ul>
<li><code>-t 200</code>: instructs Docker to wait for a grace period before shutting down</li>
</ul>
<h3 id="displaying-log-output"><a class="header" href="#displaying-log-output">Displaying log output</a></h3>
<pre><code class="language-bash">docker logs -f hornet
</code></pre>
<ul>
<li><code>-f</code> <br />
Instructs Docker to continue displaying the log to <code>stdout</code> until CTRL+C is pressed</li>
</ul>
<h2 id="removing-container"><a class="header" href="#removing-container">Removing container</a></h2>
<pre><code class="language-bash">docker container rm hornet
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../getting_started/installation_steps.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../getting_started/using_docker_compose.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../getting_started/installation_steps.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../getting_started/using_docker_compose.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
